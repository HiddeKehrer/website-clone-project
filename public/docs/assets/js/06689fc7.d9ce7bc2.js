"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[64],{3032:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"React-Native/consuming_events","title":"Consuming SDK Events","description":"Consuming Events with Event Listeners","source":"@site/docs/React-Native/consuming_events.md","sourceDirName":"React-Native","slug":"/React-Native/consuming_events","permalink":"/docs/React-Native/consuming_events","draft":false,"unlisted":false,"editUrl":"https://github.com/pipeguru/documentation/tree/main/docs/React-Native/consuming_events.md","tags":[{"inline":true,"label":"react-native","permalink":"/docs/tags/react-native"},{"inline":true,"label":"events","permalink":"/docs/tags/events"},{"inline":true,"label":"analytics","permalink":"/docs/tags/analytics"}],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Consuming SDK Events","tags":["react-native","events","analytics"],"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Triggering Experiments in React Native","permalink":"/docs/React-Native/triggering_experiments"},"next":{"title":"Swift","permalink":"/docs/category/swift"}}');var r=t(4848),s=t(8453);const a={title:"Consuming SDK Events",tags:["react-native","events","analytics"],sidebar_position:3},c=void 0,d={},o=[{value:"Consuming Events with Event Listeners",id:"consuming-events-with-event-listeners",level:2},{value:"1. Add an Event Listener",id:"1-add-an-event-listener",level:3},{value:"2. Handle Specific Events",id:"2-handle-specific-events",level:3},{value:"Available Events",id:"available-events",level:2},{value:"<code>experimentStarted</code>",id:"experimentstarted",level:3},{value:"<code>screenViewed</code>",id:"screenviewed",level:3},{value:"<code>transactionStarted</code>",id:"transactionstarted",level:3},{value:"<code>transactionCompleted</code>",id:"transactioncompleted",level:3},{value:"<code>transactionFailed</code>",id:"transactionfailed",level:3},{value:"<code>experimentDeliveryFailed</code>",id:"experimentdeliveryfailed",level:3},{value:"<code>experimentEnded</code>",id:"experimentended",level:3},{value:"Example: Forwarding Events to Adjust",id:"example-forwarding-events-to-adjust",level:2}];function l(e){const n={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"consuming-events-with-event-listeners",children:"Consuming Events with Event Listeners"}),"\n",(0,r.jsx)(n.p,{children:"PipeGuru's SDK emits a variety of events throughout the lifecycle of an experiment or feature rollout. By subscribing to these events, you can forward them to your own analytics, attribute revenue, or trigger custom in-app behavior."}),"\n",(0,r.jsxs)(n.p,{children:["The most idiomatic way to consume these events in React Native is by listening to ",(0,r.jsx)(n.code,{children:"PipeGuru.events"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"1-add-an-event-listener",children:"1. Add an Event Listener"}),"\n",(0,r.jsxs)(n.p,{children:["You can listen for all PipeGuru events by adding a listener to ",(0,r.jsx)(n.code,{children:"PipeGuru.events"}),". This is best done in a top-level component like ",(0,r.jsx)(n.code,{children:"App.tsx"})," to ensure the listener is active throughout your app's lifecycle."]}),"\n",(0,r.jsxs)(n.p,{children:["We recommend using a ",(0,r.jsx)(n.code,{children:"useEffect"})," hook to add the listener when the component mounts and remove it when it unmounts to prevent memory leaks."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { useEffect } from 'react';\nimport { PipeGuru, PipeGuruEvent, PipeGuruEventData } from '@pipeguru/react-native';\n\nconst App = () => {\n  useEffect(() => {\n    const listener = PipeGuru.events.addListener(\n      'onPipeGuruEvent',\n      (event: PipeGuruEventData) => {\n        // Handle the event here\n        console.log('PipeGuru Event Fired:', event.name, event.properties);\n      }\n    );\n\n    // Clean up the listener when the component unmounts\n    return () => {\n      listener.remove();\n    };\n  }, []);\n\n  // ... your app's components\n};\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-handle-specific-events",children:"2. Handle Specific Events"}),"\n",(0,r.jsxs)(n.p,{children:["The event listener receives a single object containing the event ",(0,r.jsx)(n.code,{children:"name"})," and its ",(0,r.jsx)(n.code,{children:"properties"}),". You can use a ",(0,r.jsx)(n.code,{children:"switch"})," statement to handle different event types. For cleaner code, we recommend using a helper function like ",(0,r.jsx)(n.code,{children:"trackAnalytics"})," to forward events to your analytics platform."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { useEffect } from 'react';\nimport { PipeGuru, PipeGuruEvent, PipeGuruEventData } from '@pipeguru/react-native';\n\n// Your analytics tracking function\nconst trackAnalytics = (eventName: string, properties: { [key: string]: any }) => {\n  // e.g., Analytics.track(eventName, properties);\n  console.log(`Tracking analytics for ${eventName}`, properties);\n};\n\nconst App = () => {\n  useEffect(() => {\n    const handlePipeGuruEvent = (event: PipeGuruEventData) => {\n      switch (event.name) {\n        case PipeGuruEvent.ExperimentStarted:\n          trackAnalytics('Experiment Started', event.properties);\n          break;\n\n        case PipeGuruEvent.ScreenViewed:\n          trackAnalytics('Screen Viewed', event.properties);\n          break;\n\n        case PipeGuruEvent.TransactionStarted:\n          trackAnalytics('Transaction Started', event.properties);\n          break;\n\n        case PipeGuruEvent.TransactionCompleted:\n          trackAnalytics('Transaction Completed', event.properties);\n          // You can also forward this to other SDKs, like Adjust\n          break;\n\n        case PipeGuruEvent.TransactionFailed:\n          // Logger.error(\"Transaction failed\", { extra: event.properties });\n          break;\n\n        case PipeGuruEvent.ExperimentDeliveryFailed:\n          // Logger.warning(\"Failed to deliver experiment\", { extra: event.properties });\n          break;\n\n        case PipeGuruEvent.ExperimentEnded:\n          trackAnalytics('Experiment Ended', event.properties);\n          break;\n      }\n    };\n\n    const listener = PipeGuru.events.addListener('onPipeGuruEvent', handlePipeGuruEvent);\n\n    return () => listener.remove();\n  }, []);\n\n  // ... your app's components\n};\n"})}),"\n",(0,r.jsx)(n.h2,{id:"available-events",children:"Available Events"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"PipeGuruEvent"})," enum provides the names for each event, and the ",(0,r.jsx)(n.code,{children:"properties"})," object contains detailed information for each stage of the user's journey."]}),"\n",(0,r.jsx)(n.h3,{id:"experimentstarted",children:(0,r.jsx)(n.code,{children:"experimentStarted"})}),"\n",(0,r.jsx)(n.p,{children:"Fired when a user is enrolled in an experiment."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"experimentId: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"campaignId: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"variantId: string"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"screenviewed",children:(0,r.jsx)(n.code,{children:"screenViewed"})}),"\n",(0,r.jsx)(n.p,{children:"Fired each time a new screen within a PipeGuru flow is presented to the user."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"screenName: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"screenId: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"experimentId: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"campaignId: string"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"transactionstarted",children:(0,r.jsx)(n.code,{children:"transactionStarted"})}),"\n",(0,r.jsx)(n.p,{children:"Fired when a transaction is initiated from an experiment screen."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"productIdentifier: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"experimentId: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"campaignId: string"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"transactioncompleted",children:(0,r.jsx)(n.code,{children:"transactionCompleted"})}),"\n",(0,r.jsx)(n.p,{children:"Fired upon successful completion of a transaction."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"productIdentifier: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"purchaseType: 'appStoreIAP' | 'internalService'"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"transactionId: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"revenue: number"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"currency: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"experimentId: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"campaignId: string"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"transactionfailed",children:(0,r.jsx)(n.code,{children:"transactionFailed"})}),"\n",(0,r.jsx)(n.p,{children:"Fired if a transaction fails."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"error: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"productIdentifier: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"experimentId: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"campaignId: string"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"experimentdeliveryfailed",children:(0,r.jsx)(n.code,{children:"experimentDeliveryFailed"})}),"\n",(0,r.jsx)(n.p,{children:"Fired when an experiment could not be loaded and a fallback was shown."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"error: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"experimentId: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"campaignId: string"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"experimentended",children:(0,r.jsx)(n.code,{children:"experimentEnded"})}),"\n",(0,r.jsx)(n.p,{children:"Fired when the user completes or exits the experiment flow."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"experimentId: string"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"campaignId: string"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"example-forwarding-events-to-adjust",children:"Example: Forwarding Events to Adjust"}),"\n",(0,r.jsx)(n.p,{children:"Here\u2019s how you can forward PipeGuru purchase events to Adjust. First, ensure you have the Adjust SDK integrated. You will need to create event tokens in your Adjust dashboard."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { Adjust, AdjustEvent } from 'react-native-adjust';\nimport { PipeGuru, PipeGuruEvent, PipeGuruEventData } from '@pipeguru/react-native';\n\n// In a real app, manage your tokens in a centralized, type-safe way.\nconst AdjustEventTokens = {\n  appStorePurchase: 'YOUR_IOS_EVENT_TOKEN', // Create in Adjust dashboard\n  internalServicePurchase: 'YOUR_INTERNAL_TOKEN', // Create in Adjust dashboard\n};\n\nconst handlePipeGuruEvent = (event: PipeGuruEventData) => {\n  if (event.name === PipeGuruEvent.TransactionCompleted) {\n    const { revenue, currency, transactionId, productIdentifier, experimentId, purchaseType } = event.properties;\n\n    let eventToken;\n    if (purchaseType === 'appStoreIAP') {\n      eventToken = AdjustEventTokens.appStorePurchase;\n    } else {\n      eventToken = AdjustEventTokens.internalServicePurchase;\n    }\n\n    const adjustEvent = new AdjustEvent(eventToken);\n    adjustEvent.setRevenue(revenue, currency);\n    adjustEvent.setTransactionId(transactionId);\n    adjustEvent.addCallbackParameter('product_id', productIdentifier);\n    adjustEvent.addCallbackParameter('pipeguru_experiment_id', experimentId);\n\n    Adjust.trackEvent(adjustEvent);\n  }\n};\n\n// Add this listener in your app's setup\nPipeGuru.events.addListener('onPipeGuruEvent', handlePipeGuruEvent);\n"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var i=t(6540);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);